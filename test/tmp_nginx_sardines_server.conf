# sardines access points# updated at Mon Jun 29 2020 16:21:00 GMT+0800 (China Standard Time)
upstream myApp1 {
    server srv1.example.com weight=3;
    server srv2.example.com weight=1;
    server srv3.example.com weight=1;
}

upstream myApp2 {
    least_conn;
    server srv1.example.com weight=1;
    server srv2.example.com weight=1;
    server srv3.example.com weight=1;
}

upstream myApp_HTTPS {
    ip_hash;
    server srv1.example.com weight=1;
    server srv2.example.com weight=1;
    server srv3.example.com weight=1;
}

server {
    listen 80;
    server_name www.example.com;

    location /myApp1_root {
        proxy_pass http://myApp1;
    }
}

server {
    listen 172.20.20.200:443 ssl;
    server_name inner.https.example.com;
    ssl_certificate inner.https.example.com.crt;
    ssl_certificate_key inner.https.example.com.key;

    location /myapp3_root {
        proxy_pass https://myApp_HTTPS;
    }
}

server {
    listen 80;
    listen 443 ssl;
    server_name https.example.com;
    ssl_certificate https.example.com.crt;
    ssl_certificate_key https.example.com.key;

    location /myApp2_root/myApp1_root {
        proxy_pass http://myApp1;
    }

    location /myApp2_root {
        proxy_pass http://myApp2;
    }

    location / {
        proxy_pass https://myApp_HTTPS;
    }
}

server {
    listen 8080 ssl;
    server_name www.example.com;
}

server {
    listen 443 ssl;
    server_name www.example.org;
}

server {
    listen 80;
    server_name www.example.net;
}

